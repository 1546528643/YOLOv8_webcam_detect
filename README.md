# YOLOv8 æ‘„åƒå¤´å®æ—¶ç›®æ ‡æ£€æµ‹ç³»ç»Ÿ

åŸºäº YOLOv8 çš„å®æ—¶ç›®æ ‡æ£€æµ‹ç³»ç»Ÿï¼Œæ”¯æŒé€šç”¨ 80 ç±» COCO ç›®æ ‡æ£€æµ‹å’Œè‡ªå®šä¹‰æ ‡é¶æ£€æµ‹ï¼Œå¹¶æä¾›ä¸€é”®æ‰“åŒ…ä¸ºå¯æ‰§è¡Œç¨‹åºåŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ¯ **é€šç”¨ç›®æ ‡æ£€æµ‹**: æ”¯æŒ COCO æ•°æ®é›† 80 ç±»ç‰©å“çš„å®æ—¶æ£€æµ‹
- ğŸ¯ **è‡ªå®šä¹‰æ ‡é¶æ£€æµ‹**: æ”¯æŒè®­ç»ƒå’Œæ£€æµ‹è‡ªå®šä¹‰æ ‡é¶ï¼ˆå¦‚åç¯é¶ï¼‰ï¼Œä¸ºæ—¥åæ¯”èµ›èµ‹èƒ½
- ğŸ“¦ **ä¸€é”®æ‰“åŒ…**: æ”¯æŒå°†ç¨‹åºæ‰“åŒ…ä¸º exe æ–‡ä»¶ä¾¿äºä½¿ç”¨
- ğŸš€ **GPU åŠ é€Ÿ**: æ”¯æŒ CUDA åŠ é€Ÿæ¨ç†
- ğŸ“¹ **å®æ—¶æ£€æµ‹**: æ”¯æŒæ‘„åƒå¤´å®æ—¶æ£€æµ‹å’Œè§†é¢‘ä¿å­˜

## å¿«é€Ÿå¼€å§‹

1) åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆå»ºè®®ï¼‰

```bash
python3 -m venv .venv && source .venv/bin/activate
```

2) å®‰è£…ä¾èµ–

```bash
pip install --upgrade pip
pip install -r requirements.txt
```

> å¦‚éœ€ GPU/CUDA åŠ é€Ÿï¼Œå»ºè®®å…ˆå‚è€ƒ PyTorch å®˜ç½‘å®‰è£…ä¸ä½  CUDA ç‰ˆæœ¬åŒ¹é…çš„ `torch/torchvision`ï¼Œå†å®‰è£…å…¶ä»–ä¾èµ–ã€‚

3) è¿è¡Œæ‘„åƒå¤´å®æ—¶æ£€æµ‹ï¼ˆé€šç”¨ 80 ç±»ï¼‰

```bash
python src/webcam_detect.py --model yolov8n.pt --camera 0 --device auto --conf 0.5 --show-fps
```

## è‡ªå®šä¹‰æ ‡é¶æ£€æµ‹

### 1. ç”Ÿæˆæ ‡é¶æ•°æ®é›†

ä½¿ç”¨å†…ç½®çš„åˆæˆæ•°æ®ç”Ÿæˆå™¨åˆ›å»ºé»‘ç™½åç¯æ ‡é¶æ•°æ®é›†ï¼š

```bash
# ç”Ÿæˆé»˜è®¤æ•°æ®é›†ï¼ˆ500 è®­ç»ƒ + 100 éªŒè¯ï¼‰
python src/generate_synthetic_targets.py --rings 10 --max-rotate 45 --noise

# è‡ªå®šä¹‰å‚æ•°
python src/generate_synthetic_targets.py --train 1000 --val 200 --imgsz 960 --rings 10 --max-rotate 30 --noise
```

### 2. è®­ç»ƒè‡ªå®šä¹‰æ¨¡å‹

```bash
# ä½¿ç”¨ YOLOv8n è®­ç»ƒ
yolo detect train data=datasets/targets/data.yaml model=yolov8n.pt imgsz=640 epochs=100 batch=-1 device=0

# ä½¿ç”¨æ›´å¤§æ¨¡å‹ï¼ˆæ¨èç”¨äºå°ç›®æ ‡ï¼‰
yolo detect train data=datasets/targets/data.yaml model=yolov8s.pt imgsz=960 epochs=150 batch=-1 device=0
```

### 3. ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹æ£€æµ‹

```bash
# ä½¿ç”¨è®­ç»ƒå¥½çš„æƒé‡è¿›è¡Œå®æ—¶æ£€æµ‹
python src/webcam_detect.py --model runs/detect/train/weights/best.pt --device auto --half --show-fps
```

## ç¨‹åºæ‰“åŒ…

### æ‰“åŒ…ä¸ºå¯æ‰§è¡Œæ–‡ä»¶

å°†ç¨‹åºæ‰“åŒ…ä¸º exe æ–‡ä»¶ï¼Œæ–¹ä¾¿å¤–è¡Œäººä½¿ç”¨ï¼š

```bash
# å®‰è£…æ‰“åŒ…å·¥å…·
pip install -U pyinstaller pyinstaller-hooks-contrib

# æ‰“åŒ…ç¨‹åºï¼ˆåŒ…å«æƒé‡æ–‡ä»¶ï¼‰
pyinstaller --noconfirm --clean --onedir --name YOLOv8Webcam `
 --collect-all ultralytics --collect-all torch --collect-all torchvision --collect-all cv2 `
 --add-data "runs/detect/train/weights/best.pt;." `
 src/webcam_detect.py

# è¿è¡Œæ‰“åŒ…åçš„ç¨‹åº
cd dist/YOLOv8Webcam
./YOLOv8Webcam.exe --model ./best.pt --device auto --half --show-fps
```

### æ‰“åŒ…æ³¨æ„äº‹é¡¹

- ç¡®ä¿æƒé‡æ–‡ä»¶è·¯å¾„æ­£ç¡®
- è‹¥ç”¨æˆ·æ—  GPUï¼Œè¿è¡Œæ—¶ä½¿ç”¨ `--device cpu` å¹¶å»æ‰ `--half`
- å»ºè®®ä½¿ç”¨ `--onedir` æ¨¡å¼ï¼Œä¾¿äºåˆ†å‘

## å¯é€‰å‚æ•°

- `--model`: æ¨¡å‹æƒé‡è·¯å¾„æˆ–æ¨¡å‹åï¼ˆé»˜è®¤ `yolov8n.pt`ï¼‰
- `--camera`: æ‘„åƒå¤´ç´¢å¼•ï¼ˆé»˜è®¤ `0`ï¼‰
- `--device`: `auto`/`cpu`/`cuda:0` ç­‰ï¼ˆé»˜è®¤ `auto`ï¼‰
- `--imgsz`: æ¨ç†åˆ†è¾¨ç‡ï¼ˆé»˜è®¤ `640`ï¼‰
- `--conf`: ç½®ä¿¡åº¦é˜ˆå€¼ï¼ˆé»˜è®¤ `0.5`ï¼‰
- `--iou`: IoU é˜ˆå€¼ï¼ˆé»˜è®¤ `0.45`ï¼‰
- `--half`: è‹¥è®¾å¤‡æ”¯æŒï¼Œä½¿ç”¨ FP16 æ¨ç†
- `--show-fps`: åœ¨çª—å£å·¦ä¸Šè§’æ˜¾ç¤º FPS
- `--save path.mp4`: å°†å¯è§†åŒ–ç»“æœä¿å­˜ä¸ºè§†é¢‘

æŒ‰ `q` é”®é€€å‡ºç¨‹åºã€‚

## é¡¹ç›®ç»“æ„

```
YOLOV8_webcam_detect/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ webcam_detect.py          # ä¸»æ£€æµ‹ç¨‹åº
â”‚   â””â”€â”€ generate_synthetic_targets.py  # æ ‡é¶æ•°æ®é›†ç”Ÿæˆå™¨
â”œâ”€â”€ datasets/
â”‚   â””â”€â”€ targets/                  # æ ‡é¶æ•°æ®é›†ç›®å½•
â”‚       â”œâ”€â”€ data.yaml            # æ•°æ®é›†é…ç½®
â”‚       â”œâ”€â”€ images/
â”‚       â”‚   â”œâ”€â”€ train/           # è®­ç»ƒå›¾ç‰‡
â”‚       â”‚   â””â”€â”€ val/             # éªŒè¯å›¾ç‰‡
â”‚       â””â”€â”€ labels/
â”‚           â”œâ”€â”€ train/           # è®­ç»ƒæ ‡ç­¾
â”‚           â””â”€â”€ val/             # éªŒè¯æ ‡ç­¾
â”œâ”€â”€ requirements.txt              # ä¾èµ–åŒ…
â””â”€â”€ README.md                     # è¯´æ˜æ–‡æ¡£
```

## è¯´æ˜

- é»˜è®¤ä½¿ç”¨ `ultralytics` YOLOv8 æ¨ç†æ¥å£ï¼Œæ”¯æŒ `numpy` çš„ `BGR` å¸§
- æ”¯æŒé€šç”¨ 80 ç±» COCO ç›®æ ‡æ£€æµ‹å’Œè‡ªå®šä¹‰æ ‡é¶æ£€æµ‹
- å†…ç½®åˆæˆæ•°æ®ç”Ÿæˆå™¨ï¼Œå¯å¿«é€Ÿåˆ›å»ºæ ‡é¶è®­ç»ƒæ•°æ®é›†
- æ”¯æŒä¸€é”®æ‰“åŒ…ä¸º exe æ–‡ä»¶ï¼Œä¾¿äºåˆ†å‘ä½¿ç”¨
- è‡ªåŠ¨è®¾å¤‡æ£€æµ‹ï¼šæœ‰ GPU æ—¶è‡ªåŠ¨ä½¿ç”¨ CUDAï¼Œæ—  GPU æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ° CPU
- éƒ¨åˆ†æ‘„åƒå¤´åœ¨ `cv2.CAP_PROP_FPS` è¿”å› 0 æ—¶ä¼šé‡‡ç”¨å…œåº•å¸§ç‡ 30 ä¿å­˜è§†é¢‘

## æŠ€æœ¯ç‰¹æ€§

- **æ¨¡å‹**: YOLOv8 (ultralytics)
- **æ¨ç†**: æ”¯æŒ CPU/GPU æ¨ç†ï¼Œè‡ªåŠ¨è®¾å¤‡é€‰æ‹©
- **æ•°æ®å¢å¼º**: å†…ç½®æ—‹è½¬ã€ç¼©æ”¾ã€å™ªå£°ç­‰å¢å¼º
- **å®æ—¶æ€§èƒ½**: æ”¯æŒ FP16 åŠ é€Ÿå’Œ FPS æ˜¾ç¤º
- **æ˜“ç”¨æ€§**: ä¸€é”®æ‰“åŒ…ï¼Œå¤–è¡Œäººå‹å¥½

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•æ£€æµ‹è‡ªå®šä¹‰ç›®æ ‡ï¼Ÿ
A: ä½¿ç”¨ `generate_synthetic_targets.py` ç”Ÿæˆæ•°æ®é›†ï¼Œç„¶åè®­ç»ƒè‡ªå®šä¹‰æ¨¡å‹ã€‚

### Q: æ‰“åŒ…åç¨‹åºæ— æ³•è¿è¡Œï¼Ÿ
A: æ£€æŸ¥æƒé‡æ–‡ä»¶è·¯å¾„ï¼Œç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„ `--add-data` å‚æ•°ã€‚

### Q: æ—  GPU ç¯å¢ƒå¦‚ä½•ä½¿ç”¨ï¼Ÿ
A: ä½¿ç”¨ `--device cpu` å‚æ•°ï¼Œå¹¶å»æ‰ `--half` å‚æ•°ã€‚

### Q: å¦‚ä½•æé«˜æ£€æµ‹ç²¾åº¦ï¼Ÿ
A: å¢åŠ è®­ç»ƒæ•°æ®é‡ï¼Œä½¿ç”¨æ›´å¤§æ¨¡å‹ï¼ˆå¦‚ yolov8s/mï¼‰ï¼Œæˆ–æé«˜æ¨ç†åˆ†è¾¨ç‡ã€‚
